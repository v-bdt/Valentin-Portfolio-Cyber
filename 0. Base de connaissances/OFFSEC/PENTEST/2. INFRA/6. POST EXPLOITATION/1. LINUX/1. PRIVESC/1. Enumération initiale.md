
- [[#ENUMERATION AUTOMATIQUE]]
- [[#ENUMERATION MANUELLE]]


1. [ ] [[#Historique des commandes]]
2. [ ] [[#Identifier les infos système]]
3. [ ] [[#Identifier les users / groups]]
4. [ ] [[#Identifier la conf Nginx / Apache (Vhosts ?)]]
5. [ ] [[#Identifier la config réseau]]
6. [ ] [[#Identifier les contrôles de sécurité]]
7. [ ] [[#Identifier les périphériques et lecteurs]]
8. [ ] [[#Identifier les fichiers et dossiers cachés]]
9. [ ] [[#Identifier les objets modifiables par l'utilisateur]]
10. [ ] [[#Identifier les partages NFS]]
11. [ ] [[#Identifier les cronjobs]]
12. [ ] [[#Identifier les processus lancés]]
13. [ ] [[#Identifier les programmes installés]]



---

# ENUMERATION AUTOMATIQUE

## LinPEAS

```
./linpeas.sh
```


---

# ENUMERATION MANUELLE


# Historique des commandes

## Historique général

```bash
history
```


## Fichiers d'historique

```shell
find / -type f \( -name *_hist -o -name *_history \) -exec ls -l {} \; 2>/dev/null
```


---

#  Identifier les infos système

## Whoami

```bash
id
```

```bash
whoami
```

## Droits sudoers

```bash
sudo -l
```

## OS Version

```bash
cat /etc/os-release
```

## Kernel Version

```bash
uname -a
cat /proc/version
```

## Hostname

```bash
hostname
```

## Path du user

```shell-session
 echo $PATH
```

## Variables d'environnement

```bash
env
```

## Infos CPU

```bash
lscpu
```

## Shells disponibles

```bash
cat /etc/shells
```


---

# Identifier les users / groups


## Users existants

```bash
cat /etc/passwd
```

## Users avec login shells

```shell
grep -E "sh$" /etc/passwd
```

```bash
grep -vE "nologin" /etc/passwd
```

## Groupes existants

```shell
cat /etc/group
```

## Lister membres d'un groupe

```shell
getent group sudo
```

## Répertoires dans /home

```shell
ls -laR /home
```

## Users last login

```shell
lastlog
```

## Users connectés en simultané

```bash
w
```

```
who
```


---
#  Identifier la conf Nginx / Apache (Vhosts ?)


```sh
ls -la /etc/nginx/sites-enabled
```

```sh
ls -la /etc/apache2/sites-available
```



---

# Identifier la config réseau

## @IP

```bash
ip a
```

```
ifconfig
```

## Table ARP

```
arp -a
```

## Table de routage

```bash
route
```

```
netstat -rn
```

## Sockets réseaux

> [!TIP]
> Sockets ouvertes sur le 127.0.0.1 ?

```bash
ss -tulnp
```

## DNS utilisés

> [!TIP]
> DNS interne à un domaine ?

```bash
cat /etc/resolv.conf
```

## Hosts

hosts particuliers configurés ?

```bash
cat /etc/hosts
```

## Ping sweep

script bash

```bash
for i in {1..254} ;do (ping -c 1 172.16.5.$i | grep "bytes from" &) ;done > hosts_up
```


```bash
cat hosts_up | awk '{print $4}' | tr -d : > hosts.txt
```


---

# Identifier les contrôles de sécurité


> [!TIP]
> Check si defenses en place ( Exec Shield, iptables, AppArmor, SELinux, Fail2ban, Snort, UFW)

```bash
apt list --installed | tr "/" " " | cut -d" " -f1,3 | sed 's/[0-9]://g' | grep -iE 'shield|iptables|apparmor|selinux|fail2ban|snort|ufw'
```



---

# Identifier les périphériques et lecteurs

## Disques et partitions

```bash
lsblk
```

## Imprimantes connectées au système

```bash
lpstat
```

## FS montés

> [!tip]
>  identifiants dans fstab ?

```bash
df -h
```

```bash
cat /etc/fstab | grep -iE 'pass|user|credential'
```

## FS démontés

```bash
cat /etc/fstab | grep -v "#" | column -t
```


---

# Identifier les fichiers et dossiers cachés

## Fichiers et dossiers cachés pour un user

```shell
find / -type f -name ".*" -exec ls -l {} \; 2>/dev/null | grep htb-student
```

## Fichiers temporaires

```shell
ls -l /tmp /var/tmp /dev/shm
```


---

# Identifier les objets modifiables par l'utilisateur


En fonction du user

```sh
find / -perm -u+w -user <user> 2>/dev/null | grep -vE "proc|run|sys"
```

En fonction du groupe

```sh
find / -perm -g+w -group <group> 2>/dev/null | grep -vE "proc|run|sys"
```

Droits Other

```sh
find / -perm -o+w 2>/dev/null | grep -vE "proc|run|sys"
```

---

# Identifier les partages NFS


```
showmount -e
```



---

# Identifier les cronjobs

Scripts planifiés dans cron ? (généralement backup)(tar command injection *)

```shell-session
ls -la /etc/cron.*/
```

```bash
cat /etc/crontab
```

Cronjobs modifiables

```
find / -path /proc -prune -o -type f -perm -o+w 2>/dev/null
```


---

# Identifier les processus lancés

## Processus lancés 

> [!TIP]
> Possible d'hijacker / écrire dans un processus lancé ?

Check processus lancés en tant que root ou autre user

```bash
ps -aux | grep <user>
```

PSPY64 -> Permet de voir les process lancés / commandes exécutées par root en direct.

```
./pspy64 -pf -i 1000 | grep 'UID=0' 
```


## Trace SysCalls

Voir les syscalls executés par un programme

```shell
strace ping -c1 10.129.112.20
```


---

# Identifier les programmes installés


## Identifier les application tierces installées

```
ls -laR /opt/
```

## Afficher les programmes installés et leur version

```bash
apt list --installed | tr "/" " " | cut -d" " -f1,3 | sed 's/[0-9]://g' | tee -a installed_pkgs.list
```

## Sudo version

```bash
sudo -V
```

## Screen version

```bash
screen --version
```

## PkExec version

Vulnérable PwnKit ? (<= 0.105-31)

```bash
apt list --installed | grep policykit
```

## Binaires compilés

```bash
ls -l /bin /usr/bin/ /usr/sbin/
```


```
curl -s https://gtfobins.github.io/ | grep bin-name | html2text | cut -d" " -f1 | sed '/^[[:space:]]*$/d'
```


## SUID / SGID -> GTFOBINS

```bash
ls -la `find / -perm /u=s,g=s -type f 2>/dev/null`
```




