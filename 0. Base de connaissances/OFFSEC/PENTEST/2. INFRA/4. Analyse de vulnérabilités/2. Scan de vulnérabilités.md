
> [!TIP]
> - Voir avec le client si des hôtes sensibles sont à exclure des scans pour ne pas causer d'instabilité.
> - Ne jamais performe des DOS checks sauf si demandé par le client ! (Safe Checks)
> - Checker la conso de bande passante.
> - Inclure les rapports de scan en Annexe du rapport de pentest.

- [[#NESSUS]]
- [[#OpenVAS]]

- [[#Check conso bandwidth]]

---
# NESSUS

- [[#INSTALLATION]]
- [[#SCANS]]
- [[#ADVANCED SETTINGS]]
- [[#EXPORTER LES RESULTATS]]
- [[#SCANNING ISSUES]]

## INSTALLATION

1. Télécharger la dernière version de Nessus -> https://www.tenable.com/downloads/nessus?loginAttempted=true
2. Récupérer un code d'activation (Essentials)-> https://www.tenable.com/products/nessus/activation-code
3. Installer le binaire

```shell-session
dpkg -i Nessus-8.15.1-ubuntu910_amd64.deb
```

4. Démarrer Nessus

```shell-session
sudo systemctl start nessusd.service
```

5. Accéder à la console Web -> https://localhost:8834 


## SCANS

1. Aller dans New Scan
2. Choisir un template
3. Remplir les infos dans Basic -> General
4. Configurer le scan
5. Save
6. Launch
#### Scans Templates

Discovery
Vulnerabilities
Compliance

https://docs.tenable.com/nessus/Content/ScanAndPolicyTemplates.htm



## ADVANCED SETTINGS

### Scan Policies

Permet de créer des templates de scan

1. Aller dans Scan -> Policies
2. Créer une Scan Policy -> New Policy
3. Choisir un template
4. Le configurer de A a Z


### Nessus Plugins

Permet de créer des Plugins Rules pour écarter des faux positifs par exemple

1. Aller dans Scan -> Plugin Rules
2. Create a new plugin rule
3. Renseigner les infos


### Scanning with Credentials

Accepte les technos de bases de données etc..

1. Dans le paramètre de Scan, aller dans l'onglet Credentials
2. Configurer les creds



## EXPORTER LES RESULTATS

Exports possible en PDF / HTML / CSV / NESSUS / DB

https://raw.githubusercontent.com/eelsivart/nessus-report-downloader/master/nessus6-report-downloader.rb

```shell-session
./nessus_downloader.rb 
```



#### Format NESSUS

1. Dans Scans -> Cliquer sur le scan
2. En haut à droite -> Export -> Nessus


## SCANNING ISSUES

Si pare feux bloquant et cause un résultat de scan avec 0 port ouverts ou tous les ports ouverts -> Reconfigurer le scan pour désactiver le "Ping the remote host" dans "Advanced Scan"

Ajuster les "Performance Options" ett modifier le "Max Concurrent Checks Per Host" sur lles réseaux / targets sensibles.

---
# OpenVAS

- [[#INSTALLATION OPENVAS]]
- [[#CONFIGURATION OPENVAS]]
- [[#SCANS OPENVAS]]
- [[#EXPORT DES RESULTATS OPENVAS]]


## INSTALLATION #OPENVAS

1. installer les packages

```shell-session
sudo apt update && sudo apt install gvm && openvas
```

2. Lancer le setup (~30min)

```shell-session
sudo gvm-setup
```

3. Check si le setup est ok

```
sudo gvm-check-setup
```

4. Lancer OpenVAS

```shell-session
sudo gvm-start
```

5. reset le mot de passe admin

```
sudo -u _gvm gvmd --user=admin --new-password=admin
```

6. Accéder à l'interface web -> https://127.0.0.1:9392

7. Aller dans Administration -> Feed Status
8. Attendre que les bases soient à jour


si pb de version postgresql -> https://gokhnayisigi.medium.com/how-to-solve-postgresql-error-during-gvm-greenbone-vulnerability-management-installation-14a352bc537f

si collation version mismatch ->  https://forum.greenbone.net/t/the-database-was-created-using-collation-version-2-35-but-the-operating-system-provides-version-2-36/13562/4

si no SCAP database found -> https://forum.greenbone.net/t/no-scap-database-found/15527/18



## CONFIGURATION #OPENVAS


1. Aller dans Configuration > Targets
2. Add a new target  ![[Pasted image 20250426210752.png]]
3. Configurer la target

![[Pasted image 20250426211122.png]]




## SCANS #OPENVAS


Types de scan conseillés:

- `Base`: This scan configuration is meant to enumerate information about the host's status and operating system information. This scan configuration does not check for vulnerabilities.
    
- `Discovery`: This scan configuration is meant to enumerate information about the system. The configuration identifies the host's services, hardware, accessible ports, and software being used on the system. This scan configuration also does not check for vulnerabilities.
    
- `Host Discovery`: This scan configuration solely tests whether the host is alive and determines what devices are `active` on the network. This scan configuration does not check for vulnerabilities as well. _OpenVAS leverages ping to identify if the host is alive._
    
- `System Discovery`: This scan enumerates the target host further than the 'Discovery Scan' and attempts to identify the operating system and hardware associated with the host.
    
- `Full and fast`: This configuration is recommended by OpenVAS as the safest option and leverages intelligence to use the best NVT checks for the host(s) based on the accessible ports.


1. Aller dans Scans -> Tasks
2. New Task
3. Configurer le scan
4. Lancer le scan (bouton play)



## EXPORT DES RESULTATS #OPENVAS



1. Aller dans Reports
2. Cliquer sur la date pour afficher le rapport
3. Cliquer sur télécharger le rapport ![[Pasted image 20250427201545.png]]
4. Télécharger au format PDF


---
# Check conso bandwidth

> [!TIP]
> - Comparer avant et pendant le scan
> - Tx / Rx = Transmission / Reception



VNSTAT

```shell-session
sudo apt install vnstat
```


Monitorer sur une interface

```shell-session
sudo vnstat -l -i eth0
```